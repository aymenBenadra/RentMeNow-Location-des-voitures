{"version":3,"sources":["../../src/js/reservation.js"],"names":["vehicles","document","querySelector","bav","getElementsByName","moteur","moteurOptions","querySelectorAll","jours","rebriquePrix","printButton","intl","Intl","NumberFormat","price","net","total","fetch","then","res","json","data","renderData","vehicleData","vehiclesData","moteurTTC","addEventListener","event","target","value","reset","forEach","b","checked","selected","disabled","filter","v","type","o","console","log","includes","tarif","format","e","style","display","printableText","window","print","currency","text"],"mappings":"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","sourcesContent":["// Reservation page\r\nconst vehicles = document.querySelector(\"#vehicles\");\r\nconst bav = document.getElementsByName(\"bav\");\r\nconst moteur = document.querySelector(\"#moteur\");\r\nconst moteurOptions = document.querySelectorAll(\"#moteur option\");\r\nconst jours = document.querySelector(\"#jours\");\r\nconst rebriquePrix = document.querySelector(\"#rebriquePrix\");\r\nconst printButton = document.querySelector(\"#print\");\r\n// formatting price\r\nlet intl = new Intl.NumberFormat(\"fr-FR\");\r\nlet price = {\r\n  net: 0,\r\n  moteur: 0,\r\n  total: 0,\r\n};\r\n\r\n// Get data from file\r\nfetch(\"./assets/db/vehicles.json\")\r\n  .then((res) => res.json())\r\n  .then((data) => renderData(data));\r\n\r\n// Render Data\r\nfunction renderData(data) {\r\n  const vehiclesData = data[\"vehicles\"];\r\n  let vehicleData;\r\n  const moteurTTC = data[\"moteurTTC\"];\r\n\r\n  vehicles.addEventListener(\"change\", (event) => {\r\n    // Reset Form\r\n    if (event.target.value == \"--\") {\r\n      document.querySelector(\"#reservation-form\").reset();\r\n      bav.forEach((b) => {\r\n        b.checked = false;\r\n      });\r\n      moteurOptions[0].selected = true;\r\n      jours.value = 1;\r\n      jours.disabled = true;\r\n      printButton.disabled = true;\r\n    } else {\r\n      // Find selected vehicle data\r\n      vehicleData = vehiclesData.filter((v) => v.type == event.target.value)[0];\r\n\r\n      // Check available BAV\r\n      bav.forEach((b) => {\r\n        if (vehicleData.bav == b.value) b.checked = true;\r\n        else b.checked = false;\r\n      });\r\n\r\n      // reset moteur options\r\n      moteurOptions[0].selected = true;\r\n\r\n      // Disable unavailable Moteurs\r\n      moteurOptions.forEach((o) => {\r\n        console.log(o.disabled);\r\n        if (vehicleData.moteur.includes(o.value) || o.value == \"--\")\r\n          o.disabled = false;\r\n        else o.disabled = true;\r\n      });\r\n\r\n      // Enable jours\r\n      jours.disabled = false;\r\n\r\n      // Enable print button\r\n      printButton.disabled = false;\r\n\r\n      // Calculate price without moteur\r\n      price.net =\r\n        vehicleData.bav == \"auto\"\r\n          ? vehicleData.tarif + vehicleData.tarif * 0.19\r\n          : vehicleData.tarif;\r\n\r\n      // multiply price by jours\r\n      price.total = price.net * jours.value;\r\n\r\n      // Append price to the form\r\n      document.querySelector(\"#prix\").value = intl.format(price.total);\r\n    }\r\n  });\r\n\r\n  // Calculate price with moteur\r\n  moteur.addEventListener(\"change\", (event) => {\r\n    if (event.target.value == \"--\") {\r\n      // Remove previous moteur price\r\n      if (price.moteur != 0) price.total -= price.moteur;\r\n      // reset price to total\r\n      document.querySelector(\"#prix\").value = intl.format(\r\n        price.total * jours.value\r\n      );\r\n    } else {\r\n      // Calculate price with moteur\r\n      if (price.moteur == 0)\r\n        price.moteur = price.net * moteurTTC[event.target.value];\r\n      else {\r\n        price.total -= price.moteur;\r\n        price.moteur = price.net * moteurTTC[event.target.value];\r\n      }\r\n      // Add moteur price to total\r\n      price.total = price.total + price.moteur;\r\n\r\n      // Append price to the form\r\n      document.querySelector(\"#prix\").value = intl.format(\r\n        price.total * jours.value\r\n      );\r\n    }\r\n  });\r\n\r\n  jours.addEventListener(\"change\", (event) => {\r\n    // Append price to the form\r\n    document.querySelector(\"#prix\").value = intl.format(\r\n      price.total * event.target.value\r\n    );\r\n  });\r\n\r\n  printButton.addEventListener(\"click\", () => {\r\n    const rebriquePrix = document.querySelector(\"#rebriquePrix\");\r\n\r\n    // Hide non printable elements\r\n    document.querySelectorAll(\".nonPrintable\").forEach((e) => {\r\n      e.style.display = \"none\";\r\n    });\r\n    rebriquePrix.value = printableText(vehicleData, price, jours.value);\r\n\r\n    // Print page\r\n    window.print();\r\n\r\n    // Reset layout\r\n    document.querySelectorAll(\".nonPrintable\").forEach((e) => {\r\n      e.style.display = \"block\";\r\n    });\r\n  });\r\n}\r\n\r\nfunction printableText(vehicleData, price, jours) {\r\n  intl = new Intl.NumberFormat(\"fr-FR\", { style: \"currency\", currency: \"EUR\" });\r\n  let text = `Selected Vehicle: ${vehicleData.type}\\n+${intl.format(vehicleData.tarif)}\\nSelected BAV:\\n${vehicleData.bav == \"auto\" ? \"Automatique +19%\" : \"Manuelle +0%\"}\\nPrix sans Moteur: ${intl.format(price.net)}\\nMoteur: ${price.moteur != 0 ? \"+\" + intl.format(price.moteur) : \"\"}\\nJours: ${jours}\\nPrix Total: ${intl.format(price.total * jours)}`;\r\n  return text;\r\n}\r\n"],"file":"reservation.min.js"}