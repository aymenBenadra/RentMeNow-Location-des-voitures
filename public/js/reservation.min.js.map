{"version":3,"sources":["../../src/js/reservation.js"],"names":["vehicles","document","querySelector","bav","getElementsByName","moteur","moteurOptions","querySelectorAll","jours","rebriquePrix","printButton","intl","Intl","NumberFormat","price","net","total","fetch","then","res","json","data","renderData","vehicleData","vehiclesData","moteurTTC","addEventListener","event","target","value","reset","forEach","b","checked","selected","disabled","filter","v","type","o","console","log","includes","tarif","format","printableText","e","style","visibility","window","print","currency","text"],"mappings":"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","sourcesContent":["// Reservation page\r\nconst vehicles = document.querySelector(\"#vehicles\");\r\nconst bav = document.getElementsByName(\"bav\");\r\nconst moteur = document.querySelector(\"#moteur\");\r\nconst moteurOptions = document.querySelectorAll(\"#moteur option\");\r\nconst jours = document.querySelector(\"#jours\");\r\nconst rebriquePrix = document.querySelector(\"#rebriquePrix\");\r\nconst printButton = document.querySelector(\"#print\");\r\n// formatting price\r\nlet intl = new Intl.NumberFormat(\"fr-FR\");\r\nlet price = {\r\n  net: 0,\r\n  moteur: 0,\r\n  total: 0,\r\n};\r\n\r\n// Get data from file\r\nfetch(\"./assets/db/vehicles.json\")\r\n  .then((res) => res.json())\r\n  .then((data) => renderData(data));\r\n\r\n// Render Data\r\nfunction renderData(data) {\r\n  const vehiclesData = data[\"vehicles\"];\r\n  const moteurTTC = data[\"moteurTTC\"];\r\n  let vehicleData;\r\n\r\n  vehicles.addEventListener(\"change\", (event) => {\r\n    // Reset Form\r\n    if (event.target.value == \"--\") {\r\n      document.querySelector(\"#reservation-form\").reset();\r\n      bav.forEach((b) => {\r\n        b.checked = false;\r\n      });\r\n      moteurOptions[0].selected = true;\r\n      jours.value = 1;\r\n      jours.disabled = true;\r\n      printButton.disabled = true;\r\n      rebriquePrix.value = \"\";\r\n      price.net = 0;\r\n      price.moteur = 0;\r\n      price.total = 0;\r\n    } else {\r\n      // Find selected vehicle data\r\n      vehicleData = vehiclesData.filter((v) => v.type == event.target.value)[0];\r\n\r\n      // Check available BAV\r\n      bav.forEach((b) => {\r\n        if (vehicleData.bav == b.value) b.checked = true;\r\n        else b.checked = false;\r\n      });\r\n\r\n      // reset moteur options\r\n      moteurOptions[0].selected = true;\r\n\r\n      // Disable unavailable Moteurs\r\n      // if (vehicleData.moteur.length > 1) {\r\n      moteurOptions.forEach((o) => {\r\n        console.log(o.disabled);\r\n        if (vehicleData.moteur.includes(o.value) || o.value == \"--\")\r\n          o.disabled = false;\r\n        else o.disabled = true;\r\n      });\r\n      // } else {\r\n      //   moteurOptions.forEach((o) => {\r\n      //     console.log(o.disabled);\r\n      //     if (vehicleData.moteur.includes(o.value)) {\r\n      //       o.disabled = false;\r\n      //       // o.selected = true;\r\n      //     } else o.disabled = true;\r\n      //   });\r\n      // }\r\n\r\n      // Enable jours\r\n      jours.disabled = false;\r\n\r\n      // Calculate price without moteur\r\n      price.net =\r\n        vehicleData.bav == \"auto\"\r\n          ? vehicleData.tarif + vehicleData.tarif * 0.19\r\n          : vehicleData.tarif;\r\n\r\n      // Calculate price with moteur\r\n      // if (price.moteur != 0) {\r\n      //   price.total -= price.moteur;\r\n      //   price.moteur = 0;\r\n      // }\r\n      // price.moteur = price.net * moteurTTC[moteur.value];\r\n      // Add moteur price to total\r\n      price.total = price.total + price.moteur;\r\n\r\n      // multiply price by jours\r\n      price.total = price.net * jours.value;\r\n\r\n      // Append price to the form\r\n      document.querySelector(\"#prix\").value = intl.format(price.total);\r\n\r\n      // update rebrique de prix\r\n      rebriquePrix.value = printableText(vehicleData);\r\n    }\r\n  });\r\n\r\n  // Calculate price with moteur\r\n  moteur.addEventListener(\"change\", (event) => {\r\n    if (event.target.value == \"--\") {\r\n      // Remove previous moteur price\r\n      if (price.moteur != 0) {\r\n        price.total -= price.moteur;\r\n        price.moteur = 0;\r\n      }\r\n\r\n      // Enable print button\r\n      printButton.disabled = true;\r\n\r\n      // Enable send button\r\n      document.querySelector(\"#send\").disabled = true;\r\n\r\n      // reset price to total\r\n      document.querySelector(\"#prix\").value = intl.format(\r\n        price.total * jours.value\r\n      );\r\n    } else {\r\n      // Calculate price with moteur\r\n      if (price.moteur != 0) {\r\n        price.total -= price.moteur;\r\n        price.moteur = 0;\r\n      }\r\n      price.moteur = price.net * moteurTTC[event.target.value];\r\n      // Add moteur price to total\r\n      price.total = price.total + price.moteur;\r\n\r\n      // Enable print button\r\n      printButton.disabled = false;\r\n\r\n      // Enable send button\r\n      document.querySelector(\"#send\").disabled = false;\r\n\r\n      // Append price to the form\r\n      document.querySelector(\"#prix\").value = intl.format(\r\n        price.total * jours.value\r\n      );\r\n    }\r\n    // update rebrique de prix\r\n    rebriquePrix.value = printableText(vehicleData);\r\n  });\r\n\r\n  jours.addEventListener(\"change\", (event) => {\r\n    // Append price to the form\r\n    document.querySelector(\"#prix\").value = intl.format(\r\n      price.total * event.target.value\r\n    );\r\n\r\n    // update rebrique de prix\r\n    rebriquePrix.value = printableText(vehicleData);\r\n  });\r\n\r\n  printButton.addEventListener(\"click\", () => {\r\n    // Hide non printable elements\r\n    document.querySelectorAll(\".nonPrintable\").forEach((e) => {\r\n      e.style.visibility = \"hidden\";\r\n    });\r\n\r\n    // Print page\r\n    window.print();\r\n\r\n    // Reset layout\r\n    document.querySelectorAll(\".nonPrintable\").forEach((e) => {\r\n      e.style.visibility = \"visible\";\r\n    });\r\n  });\r\n}\r\n\r\nfunction printableText(vehicleData) {\r\n  intl = new Intl.NumberFormat(\"fr-FR\", { style: \"currency\", currency: \"EUR\" });\r\n  let text = `Selected Vehicle: ${vehicleData.type}\\n+${intl.format(\r\n    vehicleData.tarif\r\n  )}\\nSelected BAV: ${\r\n    vehicleData.bav == \"auto\" ? \"+19%\" : \"+0%\"\r\n  }\\nPrix sans Moteur: ${intl.format(price.net)}\\n${\r\n    price.moteur != 0 ? \"Moteur: +\" + intl.format(price.moteur) + \"\\n\" : \"\"\r\n  }${\r\n    price.moteur != 0\r\n      ? \"Prix avec Moteur: \" + intl.format(price.net + price.moteur) + \"\\n\"\r\n      : \"\"\r\n  }Jours: ${jours.value}\\nPrix Total: ${intl.format(\r\n    price.total * jours.value\r\n  )}`;\r\n  return text;\r\n}\r\n"],"file":"reservation.min.js"}